# ============================================
# LOKI HELM VALUES
# ============================================
# #### Controls log aggregation deployment mode, storage, and runtime limits. ####

# ============================================
# DEPLOYMENT MODE
# ============================================
# #### SingleBinary keeps Loki in one process/pod (simple and cost-effective for small clusters). ####
deploymentMode: SingleBinary

loki:
  # #### auth_enabled ####
  # #### Disabled because access is expected to be controlled at cluster/network level in this setup. ####
  auth_enabled: false
  # #### commonConfig ####
  # #### replication_factor=1 and inmemory ring are appropriate for single-replica deployments. ####
  commonConfig:
    replication_factor: 1
    ring:
      kvstore:
        store: inmemory
  # #### schemaConfig ####
  # #### Defines how Loki indexes log data; v13 + boltdb-shipper is stable for filesystem-backed storage. ####
  schemaConfig:
    configs:
    - from: 2024-01-01
      store: boltdb-shipper
      object_store: filesystem
      schema: v13
      index:
        prefix: loki_index_
        period: 24h
  # #### storageConfig ####
  # #### Stores chunks and index data on local persistent volume. ####
  storageConfig:
    boltdb_shipper:
      shared_store: filesystem
    filesystem:
      directory: /var/loki/chunks
  # #### storage ####
  # #### Explicitly selects filesystem object store backend. ####
  storage:
    type: filesystem
  # #### limits_config ####
  # #### Structured metadata is disabled to reduce ingestion/storage complexity. ####
  limits_config:
    allow_structured_metadata: false

# ============================================
# SINGLE-BINARY RUNTIME SETTINGS
# ============================================
# #### Runtime pod settings: replica count, PVC size, and resource guardrails. ####
singleBinary:
  replicas: 1
  persistence:
    enabled: true
    size: 5Gi
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 300m
      memory: 512Mi

# ============================================
# SCALABLE MODE COMPONENTS (DISABLED)
# ============================================
# #### Disabled because this deployment uses SingleBinary mode only. ####
simpleScalable:
  replicas: 0

read:
  replicas: 0

write:
  replicas: 0

backend:
  replicas: 0

# ============================================
# CACHES (DISABLED)
# ============================================
# #### Memcached caches are disabled to keep the deployment minimal. ####
chunksCache:
  enabled: false

resultsCache:
  enabled: false
